<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emaulador - Emulador de Sistema Emanuel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéÆ</text></svg>">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-gamepad"></i>
                    <h1>Emaulador</h1>
                </div>
                <p class="subtitle">Emulador de Sistema Emanuel | Suporte para ROMs .bin</p>
            </div>
        </header>
        
        <div class="main-content">
            <!-- Left Panel: Emulator Screen -->
            <div class="emulator-panel">
                <div class="screen-container">
                    <div class="screen-header">
                        <h2><i class="fas fa-tv"></i> Tela do Emulador</h2>
                        <div class="screen-controls">
                            <span class="screen-indicator">
                                <span class="led led-active"></span>
                                <span id="screenStatus">Aguardando ROM</span>
                            </span>
                            <button class="btn-icon" onclick="toggleScreenFilter()" title="Filtro de tela">
                                <i class="fas fa-sliders-h"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="screen-wrapper">
                        <canvas id="gameCanvas" width="256" height="240"></canvas>
                        <div id="scanlines"></div>
                        <div id="screenFilter" class="screen-filter crt-effect"></div>
                        
                        <div id="canvasPlaceholder" class="canvas-placeholder">
                            <div class="placeholder-content">
                                <i class="fas fa-microchip"></i>
                                <h3>EMAULADOR</h3>
                                <p>Sistema de Emula√ß√£o Emanuel</p>
                                <div class="placeholder-info">
                                    <p><i class="fas fa-info-circle"></i> Carregue uma ROM .bin para iniciar</p>
                                    <p><i class="fas fa-download"></i> Arraste ou clique para carregar</p>
                                </div>
                            </div>
                        </div>
                        
                        <div id="loadingOverlay" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <p>Carregando ROM...</p>
                        </div>
                    </div>
                    
                    <div class="screen-footer">
                        <div class="fps-counter">
                            <i class="fas fa-tachometer-alt"></i>
                            <span id="fpsCounter">0 FPS</span>
                        </div>
                        <div class="cycle-counter">
                            <i class="fas fa-redo"></i>
                            <span id="cycleCounter">0 ciclos</span>
                        </div>
                    </div>
                </div>
                
                <!-- Debug Information Panel -->
                <div class="debug-panel">
                    <h3><i class="fas fa-bug"></i> Informa√ß√µes de Depura√ß√£o</h3>
                    <div class="debug-grid">
                        <div class="debug-item">
                            <label>PC:</label>
                            <span id="debugPC">0x0000</span>
                        </div>
                        <div class="debug-item">
                            <label>A:</label>
                            <span id="debugA">0x00</span>
                        </div>
                        <div class="debug-item">
                            <label>X:</label>
                            <span id="debugX">0x00</span>
                        </div>
                        <div class="debug-item">
                            <label>Y:</label>
                            <span id="debugY">0x00</span>
                        </div>
                        <div class="debug-item">
                            <label>SP:</label>
                            <span id="debugSP">0x00</span>
                        </div>
                        <div class="debug-item">
                            <label>Flags:</label>
                            <span id="debugFlags">0x00</span>
                        </div>
                        <div class="debug-item">
                            <label>Mem√≥ria:</label>
                            <span id="debugMemory">0/64KB</span>
                        </div>
                        <div class="debug-item">
                            <label>Estado:</label>
                            <span id="debugState">Parado</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right Panel: Controls -->
            <div class="controls-panel">
                <!-- File Upload Section -->
                <div class="control-section">
                    <h3><i class="fas fa-file-upload"></i> Carregar ROM</h3>
                    <div class="file-upload-container">
                        <div class="file-upload-area" onclick="document.getElementById('romFile').click()" 
                             ondragover="handleDragOver(event)" ondrop="handleFileDrop(event)">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p class="upload-text">Clique ou arraste arquivos .bin aqui</p>
                            <p class="upload-subtext">Suporta ROMs do Sistema Emanuel</p>
                            <div class="upload-stats">
                                <span><i class="fas fa-hdd"></i> Tamanho m√°ximo: 4MB</span>
                                <span><i class="fas fa-file-code"></i> Formato: Bin√°rio puro</span>
                            </div>
                        </div>
                        <input type="file" id="romFile" accept=".bin,.rom" onchange="loadROMFile(event)" multiple>
                        
                        <div class="rom-history">
                            <h4><i class="fas fa-history"></i> Hist√≥rico de ROMs</h4>
                            <div id="romHistoryList" class="history-list">
                                <!-- ROM history will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Emulator Controls -->
                <div class="control-section">
                    <h3><i class="fas fa-gamepad"></i> Controles do Emulador</h3>
                    <div class="control-grid">
                        <button id="startBtn" class="btn-control btn-success" onclick="startEmulation()" disabled>
                            <i class="fas fa-play"></i>
                            <span>Iniciar</span>
                        </button>
                        <button id="pauseBtn" class="btn-control btn-warning" onclick="pauseEmulation()" disabled>
                            <i class="fas fa-pause"></i>
                            <span>Pausar</span>
                        </button>
                        <button id="resetBtn" class="btn-control btn-primary" onclick="resetEmulation()" disabled>
                            <i class="fas fa-redo"></i>
                            <span>Reiniciar</span>
                        </button>
                        <button id="stopBtn" class="btn-control btn-danger" onclick="stopEmulation()" disabled>
                            <i class="fas fa-stop"></i>
                            <span>Parar</span>
                        </button>
                        <button id="stepBtn" class="btn-control btn-secondary" onclick="stepEmulation()" disabled>
                            <i class="fas fa-step-forward"></i>
                            <span>Passo</span>
                        </button>
                        <button id="frameBtn" class="btn-control btn-info" onclick="stepFrame()" disabled>
                            <i class="fas fa-film"></i>
                            <span>Quadro</span>
                        </button>
                    </div>
                    
                    <div class="speed-control">
                        <label><i class="fas fa-tachometer-alt"></i> Velocidade:</label>
                        <div class="speed-slider">
                            <input type="range" id="speedSlider" min="1" max="400" value="100" oninput="updateSpeed(this.value)">
                            <div class="speed-labels">
                                <span>0.25x</span>
                                <span id="speedValue">1.0x</span>
                                <span>4.0x</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Input Configuration -->
                <div class="control-section">
                    <h3><i class="fas fa-keyboard"></i> Configura√ß√£o de Controles</h3>
                    <div class="input-config">
                        <div class="input-grid">
                            <div class="input-item" data-key="up">
                                <span class="input-label">Cima</span>
                                <span class="input-key">‚Üë</span>
                                <button class="btn-remap" onclick="remapKey('up')">Remapear</button>
                            </div>
                            <div class="input-item" data-key="down">
                                <span class="input-label">Baixo</span>
                                <span class="input-key">‚Üì</span>
                                <button class="btn-remap" onclick="remapKey('down')">Remapear</button>
                            </div>
                            <div class="input-item" data-key="left">
                                <span class="input-label">Esquerda</span>
                                <span class="input-key">‚Üê</span>
                                <button class="btn-remap" onclick="remapKey('left')">Remapear</button>
                            </div>
                            <div class="input-item" data-key="right">
                                <span class="input-label">Direita</span>
                                <span class="input-key">‚Üí</span>
                                <button class="btn-remap" onclick="remapKey('right')">Remapear</button>
                            </div>
                            <div class="input-item" data-key="a">
                                <span class="input-label">Bot√£o A</span>
                                <span class="input-key">Z</span>
                                <button class="btn-remap" onclick="remapKey('a')">Remapear</button>
                            </div>
                            <div class="input-item" data-key="b">
                                <span class="input-label">Bot√£o B</span>
                                <span class="input-key">X</span>
                                <button class="btn-remap" onclick="remapKey('b')">Remapear</button>
                            </div>
                            <div class="input-item" data-key="start">
                                <span class="input-label">Start</span>
                                <span class="input-key">Enter</span>
                                <button class="btn-remap" onclick="remapKey('start')">Remapear</button>
                            </div>
                            <div class="input-item" data-key="select">
                                <span class="input-label">Select</span>
                                <span class="input-key">Espa√ßo</span>
                                <button class="btn-remap" onclick="remapKey('select')">Remapear</button>
                            </div>
                        </div>
                        <button class="btn-reset-keys" onclick="resetKeyMapping()">
                            <i class="fas fa-undo"></i> Redefinir Mapeamento
                        </button>
                    </div>
                </div>
                
                <!-- System Information -->
                <div class="control-section">
                    <h3><i class="fas fa-info-circle"></i> Informa√ß√µes do Sistema</h3>
                    <div class="system-info">
                        <div class="info-item">
                            <span class="info-label">ROM Carregada:</span>
                            <span id="infoRomName" class="info-value">Nenhuma</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Tamanho:</span>
                            <span id="infoRomSize" class="info-value">0 KB</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Checksum:</span>
                            <span id="infoChecksum" class="info-value">N/A</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Sistema:</span>
                            <span class="info-value">Emanuel Emulation</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">CPU:</span>
                            <span class="info-value">8-bit Custom</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Resolu√ß√£o:</span>
                            <span class="info-value">256x240</span>
                        </div>
                    </div>
                </div>
                
                <!-- Save States -->
                <div class="control-section">
                    <h3><i class="fas fa-save"></i> Estados Salvos</h3>
                    <div class="save-states">
                        <div class="state-slots">
                            <button class="state-slot" onclick="saveState(1)" title="Salvar no slot 1">
                                <i class="fas fa-save"></i> 1
                            </button>
                            <button class="state-slot" onclick="loadState(1)" title="Carregar do slot 1" disabled>
                                <i class="fas fa-folder-open"></i> 1
                            </button>
                            <button class="state-slot" onclick="saveState(2)" title="Salvar no slot 2">
                                <i class="fas fa-save"></i> 2
                            </button>
                            <button class="state-slot" onclick="loadState(2)" title="Carregar do slot 2" disabled>
                                <i class="fas fa-folder-open"></i> 2
                            </button>
                            <button class="state-slot" onclick="saveState(3)" title="Salvar no slot 3">
                                <i class="fas fa-save"></i> 3
                            </button>
                            <button class="state-slot" onclick="loadState(3)" title="Carregar do slot 3" disabled>
                                <i class="fas fa-folder-open"></i> 3
                            </button>
                        </div>
                        <div class="state-info">
                            <p><i class="fas fa-lightbulb"></i> Salve seu progresso em qualquer ponto!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bottom Status Bar -->
        <div class="status-bar">
            <div class="status-left">
                <div class="status-item">
                    <i class="fas fa-microchip"></i>
                    <span id="statusEmulator">Emaulador v1.0</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-clock"></i>
                    <span id="statusUptime">00:00:00</span>
                </div>
            </div>
            <div class="status-right">
                <div class="status-item">
                    <i class="fas fa-memory"></i>
                    <span id="statusMemory">-</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-bolt"></i>
                    <span id="statusPerformance">-</span>
                </div>
                <button class="btn-icon status-btn" onclick="showSystemInfo()" title="Informa√ß√µes do Sistema">
                    <i class="fas fa-info"></i>
                </button>
            </div>
        </div>
        
        <!-- Quick Actions Bar -->
        <div class="quick-actions">
            <button class="quick-action" onclick="quickSave()" title="Salvamento R√°pido (F5)">
                <i class="fas fa-bolt"></i>
                <span>Salv. R√°pido</span>
            </button>
            <button class="quick-action" onclick="quickLoad()" title="Carregamento R√°pido (F7)" disabled>
                <i class="fas fa-history"></i>
                <span>Carreg. R√°pido</span>
            </button>
            <button class="quick-action" onclick="toggleMute()" title="Alternar Mudo (M)">
                <i class="fas fa-volume-up"></i>
                <span>√Åudio</span>
            </button>
            <button class="quick-action" onclick="toggleFullscreen()" title="Tela Cheia (F11)">
                <i class="fas fa-expand"></i>
                <span>Tela Cheia</span>
            </button>
            <button class="quick-action" onclick="takeScreenshot()" title="Capturar Tela (F12)">
                <i class="fas fa-camera"></i>
                <span>Captura</span>
            </button>
            <button class="quick-action" onclick="showHelp()" title="Ajuda (F1)">
                <i class="fas fa-question-circle"></i>
                <span>Ajuda</span>
            </button>
        </div>
    </div>
    
    <!-- Theme Toggle Button -->
    <button id="themeToggle" class="theme-toggle" onclick="toggleTheme()" title="Alternar Tema (T)">
        <i class="fas fa-moon"></i>
    </button>
    
    <!-- Modal for Key Remapping -->
    <div id="remapModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-keyboard"></i> Remapear Tecla</h3>
            <p id="remapInstruction">Pressione uma tecla para atribuir a a√ß√£o...</p>
            <div class="modal-buttons">
                <button onclick="cancelRemap()" class="btn-secondary">Cancelar</button>
                <button onclick="clearKeyMapping()" class="btn-danger">Limpar</button>
            </div>
        </div>
    </div>
    
    <!-- JavaScript Files -->
    <script src="script.js"></script>
    <script src="cpu.js"></script>
    <script src="memory.js"></script>
    <script src="ppu.js"></script>
    <script src="audio.js"></script>
    <script src="input.js"></script>
    <script src="utils.js"></script>
    
    <script>
        // Initialize emulator when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeUI();
            initializeEmulatorCore();
            loadSettings();
            updateUptime();
            setInterval(updateUptime, 1000);
        });
        
        // Prevent drag and drop default behavior
        document.addEventListener('dragover', function(e) {
            e.preventDefault();
            e.stopPropagation();
        });
        
        document.addEventListener('drop', function(e) {
            e.preventDefault();
            e.stopPropagation();
        });
    </script>
</body>
</html>